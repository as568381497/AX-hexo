<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">



<title>iOS之架构搭建 | AXIHOME</title>



    <link rel="icon" href="/favicon.png">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    


<meta name="generator" content="Hexo 6.0.0"></head>
<body>
    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">阿西&#39;s Blog</a></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/category">Categories</a>
                
                    <a class="menu-item" href="/tag">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>

        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">阿西&#39;s Blog</a><a id="mobile-toggle-theme">·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/category">Categories</a>
                
                    <a class="menu-item" href="/tag">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
        <div class="main">
            <div class="container">
    
    
        <div id="post-toc" class="post-toc">
            <span class="post-toc-title">catalogue</span>
            <div class="post-toc-content">
                <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E9%A1%B9%E7%9B%AE%E6%9E%B6%E6%9E%84%E5%88%86%E5%B1%82"><span class="toc-text">1.项目架构分层</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E4%B8%AD%E9%97%B4%E5%B1%82"><span class="toc-text">2.中间层</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E4%B8%BE%E4%BE%8B"><span class="toc-text">3.举例</span></a></li></ol>
            </div>
        </div>
    
    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">iOS之架构搭建</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">Chen Xin</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">March 15, 2023&nbsp;&nbsp;15:26:04</a>
                        </span>
                    
                    
                        <span class="post-category">
                    Category:
                            
                                <a href="/categories/iOS/">iOS</a>
                            
                        </span>
                    
                </div>
            
        </header>

        <section class="post-content">
            <p>一个项目在体量够小的情况下，是不需要考虑架构问题的，因此考虑架构问题都是需要一定体量的项目，比如预想到这个项目可能会比较复杂很大，所以，我们就要在前期做好项目架构搭建的问题。</p>
<p>说到项目架构，其实本质上就是方便开发，最重要的是，将复杂的项目开发尽可能的简单话，不至于项目越开发约复杂，越难。</p>
<h2 id="1-项目架构分层"><a href="#1-项目架构分层" class="headerlink" title="1.项目架构分层"></a>1.项目架构分层</h2><p>在项目开发中，如果已经需要考虑到项目架构的话，一般可以，尝试分为以下几层：</p>
<ol>
<li>基础支撑层：也就是用于打基础服务的层级，比如工具类，网络请求封装，数据持久化处理，安全加密等核心服务。在设计时，此层的类或模块应封装得足够好，用于被上层调用，不涉及具体的业务逻辑。 </li>
<li>业务层：这一层主要管理和实施大部分的业务逻辑，各模块之间以及用户和后台之间的交互。设计上需要针对抽象过程进行解耦，设定容易理解的接口，使其具备良好的可维护性。另外，我们促合理使用设计模式（如工厂模式，装饰者模式，责任链模式等）来提升代码质量。 </li>
<li>辅助层： 这层包括了开发平台，测试，发布，性能监控等。至于开发平台，一般会选用Xcode，同时可以结合诸如Git之类的版本控制工具进行开发。 对于测试，我们会倾向于使用单元测试框架如XCTest, Quick等，也用一些UI测试框架如EarlGrey或者XCUITest, 还要做一些性能测试如内存, IO, CPU的消耗。 发布的话，一般会使用持续集成的工具如Jenkins，fastlane等帮助自动打包，并且我们也会用一些监控工具例如New Relic进行性能监控。 </li>
<li>中间层： 中间层更像是一个桥梁，用于连接各个系统，包括APP内部不同模块间的通讯，还有和服务器之间的通讯。 此层要处理好数据传递，同步和异步处理机制，异常处理等。 这些是我的一些思路，但具体还要看实际项目的需求。 有问题随时欢迎交流。</li>
</ol>
<h2 id="2-中间层"><a href="#2-中间层" class="headerlink" title="2.中间层"></a>2.中间层</h2><p>在软件架构中，着重要介绍下中间层，中间层（Middleware）扮演着非常关键的角色，它在基础支撑层和业务层之间起到沟通、协调作用，连接并管理各个不同的系统。<br>在iOS项目中，中间层可以涉及到以下几个部分： </p>
<ol>
<li>数据处理： 数据最初的来源可能来自于后端接口、数据库或本地缓存等地方，中间层要负责将这些数据按照业务需求处理之后提供给业务层使用。同时也负责业务层产生的新数据如何下沉到合适的数据源中。这类数据处理既包括数据格式的转换（例如：JSON 转 Model），也包括数据的存储和获取（如：数据库操作）。 </li>
<li>网络请求： 网络请求是移动应用中必不可少的模块，中间层在这里的作用主要是封装网络请求库，将易变的部分（如，请求地址、请求参数等）抽象出来，与业务层隔离开。 </li>
<li>安全机制： 中间层需要处理如加密解密，用户权限校验等安全相关的事宜，比如在发送网络请求时，中间层可以负责对请求的参数进行加密，并在收到响应后进行解密。 </li>
<li>路由管理： 在iOS项目中，做好路由管理极为重要。中间层可以通过Route组件来统一管理App内页面的跳转与传值，同样可以做到模块与模块之间的解耦。</li>
<li>错误处理： 在中间层通过捕获并处理各种可能出现的错误（包括网络请求错误，数据处理错误等），并将处理结果反馈给业务层，降低业务层的复杂度。 对于一个好的中间层设计，其中的部分模块应该是可插拔的，以便根据不同需求或场景进行更换，如网络库、数据库等。同时，中间层在设计时还需要考虑其性能消耗以及维护成本，确保其在保证功能的同时，不影响应用的性能。</li>
</ol>
<h2 id="3-举例"><a href="#3-举例" class="headerlink" title="3.举例"></a>3.举例</h2><p>我们以一个简单的登录功能为例子，下面我将介绍中间层在其中的作用。 我们以用户输入用户名和密码点击登录按钮为开始。</p>
<ol>
<li>业务层： 在用户点击登录按钮后，业务逻辑开始执行，先进行输入校验（例如：用户名密码是否为空，密码是否符合规则等），校验没问题后，调用中间层服务发起登录请求。 </li>
<li>中间层： 在接到登录服务调用后，先封装网络请求参数，如需要的话进行参数的加密处理，然后调用网络请求库发送网络请求。 </li>
<li>基础支撑层： 网络请求库开始进行具体的网络操作。这部分都是系统底层的操作，不需要我们自己关心。 </li>
<li>中间层： 网络请求返回后，中间层首先接收到这个返回值，对返回值进行处理，比如如果有加密需要进行解密，然后再进行一步的错误检查，如果返回错误（如：服务器返回的用户不存在、密码错误等信息）将错误信息传递给业务层，否则就将成功的登录信息（如：用户的token）传递给业务层。 </li>
<li>业务层： 业务层之后的操作根据登录的成功或者失败进行相应的业务处理，比如将用户登录的token保存，然后跳转到首页，或者是显示错误提示等。 以上就是中间层在登录功能中的一个简单样例展示，我们能看到在其中的中间层负责了数据和服务的处理，处理完成后再返回给业务层，这样就能够使得业务层的逻辑更加清晰，也更便于维护。</li>
</ol>

        </section>

        
            <section class="post-copyright">
                
                    <p class="copyright-item">
                        <span>Author:</span>
                        <span>Chen Xin</span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>Permalink:</span>
                        <span><a href="http://axibreaking.ml/2023/03/15/2023/iOS%E4%B9%8B%E6%9E%B6%E6%9E%84%E6%90%AD%E5%BB%BA/">http://axibreaking.ml/2023/03/15/2023/iOS%E4%B9%8B%E6%9E%B6%E6%9E%84%E6%90%AD%E5%BB%BA/</a></span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>License:</span>
                        <span>Copyright (c) 2019 <a target="_blank" rel="noopener" href="http://creativecommons.org/licenses/by-nc/4.0/">CC-BY-NC-4.0</a> LICENSE</span>
                    </p>
                
                

            </section>
        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                    
                        <a href="/tags/iOS/"># iOS</a>
                    
                        
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
                <a class="prev" rel="prev" href="/2023/07/11/2023/iOS%E4%B9%8B%E9%9D%99%E6%80%81%E5%BA%93%E7%94%9F%E6%88%90/">iOS之静态库生成</a>
            
            
            <a class="next" rel="next" href="/2022/10/28/2022/iOS%E4%B9%8B%E5%BC%80%E5%B1%8F%E9%A1%B5%E5%9B%BE%E7%89%87%E5%8A%A0%E8%BD%BD%E9%97%AE%E9%A2%98/">iOS之开屏页图片加载问题</a>
            
        </section>


    </article>
</div>

        </div>
        <footer id="footer" class="footer">
    <div class="copyright">
        <span>© Chen Xin | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Sirice19/hexo-theme-Chic" target="_blank">Chic</a></span>
    </div>
</footer>
    </div>
</body>
</html>